<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Vocabulary Quiz - ALC Course</title>
</head>
<body>
  <!-- Gerekli HTML yapısı burada (sadeleştirildi) -->
  <input type="text" id="username" placeholder="Adınızı girin" />
  <input type="number" id="numQuestions" value="10" />
  <button id="startBtn">Teste Başla</button>
  <button id="finishBtn">Bitir</button>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyDVhBgFfTtaiz5lzVF8rAyrrRPSfvQE89Y",
      authDomain: "vocabularyapp-239c0.firebaseapp.com",
      projectId: "vocabularyapp-239c0",
      storageBucket: "vocabularyapp-239c0.appspot.com",
      messagingSenderId: "126452247334",
      appId: "1:126452247334:web:07ae3d8a1529b41e41afe7",
      measurementId: "G-LXCFP7NPK9",
      databaseURL: "https://vocabularyapp-239c0-default-rtdb.europe-west1.firebasedatabase.app/"
    };
    firebase.initializeApp(firebaseConfig);

    const startBtn = document.getElementById("startBtn");
    const finishBtn = document.getElementById("finishBtn");

    let quizData = [], answered = [], total = 0;
    let quizUser = "";
    let startTime = "";

    startBtn.onclick = () => {
      quizUser = document.getElementById("username").value.trim();
      const numQuestions = parseInt(document.getElementById("numQuestions").value);

      if (!quizUser || isNaN(numQuestions) || numQuestions < 1) {
        alert("Lütfen geçerli bilgiler girin.");
        return;
      }

      startTime = new Date().toISOString();

      firebase.database().ref("quizLogs").push({
        user: quizUser,
        status: "başladı",
        date: startTime,
        totalQuestions: numQuestions
      });

      // örnek veri simülasyonu
      fetch("quiz-data.json").then(res => res.json()).then(data => {
        quizData = data.slice(0, numQuestions);
        total = quizData.length;
        answered = new Array(total).fill(null);
        alert("Test başladı!");
      });
    };

    finishBtn.onclick = () => {
      const endTime = new Date().toISOString();
      let correct = 0;

      for (let i = 0; i < answered.length; i++) {
        if (answered[i] === quizData[i]?.answer) correct++;
      }

      firebase.database().ref("quizLogs").push({
        user: quizUser,
        status: "bitti",
        date: endTime,
        totalQuestions: total,
        correct: correct,
        wrong: total - correct
      });

      alert("Test tamamlandı!");
    };
  </script>
</body>
</html>
